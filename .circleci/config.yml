# Use the latest 2.1 version of CircleCI pipeline process engine. See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1
parameters:
  nice-tag:
    type: string
    default: "@org/package@version"
    
jobs:
  format-tag:
    docker:
      - image: circleci/python:latest
    #environment:
    #  IMAGETAG: "${sed 's/@//' \<<< << pipeline.parameters.nice-tag >> | sed 's/\//-/' | sed 's/@/./'}"
    steps:
      - run:
          command: |
            echo << pipeline.parameters.nice-tag >>
            echo $IMAGETAG
                    
workflows:
  # Name the workflow "welcome"
  welcome:
    jobs:
      - format-tag:
          pre-steps:
            - run:
                command: |
                  echo "IMAGETAG=$(sed 's/@//' \<<< << pipeline.parameters.nice-tag >> | sed 's/\//-/' | sed 's/@/./')" >> $BASH_ENV
                # source $BASH_ENV
